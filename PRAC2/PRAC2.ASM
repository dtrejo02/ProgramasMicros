
			DATOA		EQU			0X20
			DATOB		EQU			0X21
			DATOD		EQU			0X22
			CNT			EQU			0X23
			RESB		EQU			0X24
			SEQ			EQU			0X25
			
			INCLUDE		<D:\dtrej\Documents\Escuela\Micros\PROGRAMAS\ENCABEZADO\ENCABEZADO.ASM> ;B1
			CLRF		TRISC		;COLOCAMOS COMO SALIDA EL PUERTO C.
			BCF			TRISB,7		;COLOCAMOS EL BIT 7 DEL PUERTO B COMO SALIDA.
			BCF			TRISB,4		;COLOCAMOS EL BIT 4 DEL PUERTO B COMO SALIDA PARA EL SERVO
			BCF			STATUS,RP0	;B0.
			
PUSHES:		BTFSC		PORTB,0
			GOTO		CALCU
			BTFSC		PORTB,1		;EL PUSH1  ESTA ACTIVADO?
			GOTO		G45			;SI EL PUSH1 ESTA ACTIVADO VA A LA SUMA
			BTFSC		PORTB,2		;EL PUSH2 ESTA ACTIVO?
			GOTO		G90			;SI EL PUSH2 ESTA ACTIVADO VA A LA RESTA
			BTFSC		PORTB,3		;EL PUSH3 ESTA ACTIVO?
			GOTO		G135		;SI EL PUSH3 ESTA ACTIVADO VA A LA MULTIPLICACION
			GOTO		PUSHES		;SI NINGUNO DE LOS PUSHES SE ACTIVO ENTRA EN BUCLE HASTA QUE UNO SE ACTIVE
			
G45:		PUSHMAC		PORTB,1		;ELIMINAMOS LOS REBOTES DEL PUSH
GD45:		BSF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 1
			SUBT3V		.1,.44,.3	;HACEMOS EL DELAY PARA QUE SE PONGA EN 45°
			BCF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 0
			SUBT3V		.2,.123,.11 ;LLAMAMOS AL RESTO DEL TIEMPO PARA CUMPLIR CON LOS 50Hz
			GOTO		GD45		;LO COLOCAMOS EN BUCLE PARA QUE NO SE MUEVA EL SERVO

G90:		PUSHMAC		PORTB,2		;ELIMINAMOS LOS REBOTES DEL PUSH
GD90:		BSF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 1
			SUBT3V		.2,.47,.2	;HACEMOS EL DELAY PARA QUE SE PONGA EN 90°
			BCF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 0
			SUBT3V		.1,.34,.77	;LLAMAMOS AL RESTO DEL TIEMPO PARA CUMPLIR CON LOS 50Hz
			GOTO		GD90		;LO COLOCAMOS EN BUCLE PARA QUE NO SE MUEVA EL SERVO

G135:		PUSHMAC		PORTB,3		;ELIMINAMOS LOS REBOTES DEL PUSH
GD135:		BSF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 1
			SUBT3V		.1,.65,.4	;HACEMOS EL DELAY PARA QUE SE PONGA EN 135°
			BCF			PORTB,4		;COLOCAMOS EL PIN4 DEL PORTB EN 0
			SUBT3V		.3,.7,.114	;LLAMAMOS AL RESTO DEL TIEMPO PARA CUMPLIR CON LOS 50Hz
			GOTO		GD135		;LO COLOCAMOS EN BUCLE PARA QUE NO SE MUEVA EL SERVO

CALCU:		PUSHMAC		PORTB,0		;ELIMINAMOS LOS REBOTES DEL PUSH
			MOVF		PORTD,W		;CARGA EL VALOR DE D A W.
			MOVWF		DATOA		;GUARDA EL VALOR 1 EN DATOA.
			MOVWF		PORTC		;MUESTRA EL VALOR 1 EN EL PUERTOC.
GUARDA2:	BTFSS		PORTB,0		;PREGUNTMOS POR EL PUSH
			GOTO		GUARDA2		;EN CASO DE QUE NO SE ACTIVE ENTRAMOS EN BUCLE HASTA QUE SE ACTIVE
			PUSHMAC		PORTB,0		;ELIMINAMOS LOS REBOTES DEL PUSH
			MOVF		PORTD,W		;CARGA EL CONTENIDO DEL PORTD EN W
			MOVWF		DATOB		;VALOR2 B	
			MOVWF		RESB		;CARGAMOS OTRA VEZ EL VALOR B
			CALL		LUCES		;VAMOS A HACER LA SUBRUTINA LUCES
			;CALL		SUMA		;TERMINANDO LA SUBRUTINA DE LUCES HACEMOS LA SUMA
			;CALL		RESTA		;TEMINANDO LA SUMA HACEMOS LA RESTA
			;CALL		MULTI		;TERMINANDO LA RESTA HACEMOS LA MULTIPLICACION
			;CALL		DIV			;TERMINANDO LA MULTI HACEMOS LA DIVISION
			GOTO		$

LUCES:		CLRF		PORTC		;LIMPIAMOS PORTC
			CALL		MS300		;LLAMAMOS A LA SUBRUTINA DE 300ms
			RLF			PORTC,F		;EMPEZAMOS A ENCENDER LOS LEDS DE UNO EN UNO, DE DERECHA A IZQUIERDA Y VISCEVERSA
			CALL		MS300		
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RLF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F
			CALL		MS300
			RRF			PORTC,F		;AQUI TERMINA DE ENCENDER DE UNO EN UNO LOS LEDS
			CALL		MS300
			CLRF		PORTC		;LIMPIAMOS EL PORT C
			CALL		MS300
			MOVLW		0X01		;COMENZAMOS A ENCENDER LA OTRA SUBRUTINA DE LEDS CON APOYO DE LA INSTRUCCION AND
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X03
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X07
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X0F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X1F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X3F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X7F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300			
			MOVLW		0XFF
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X7F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X3F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X1F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X0F
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X07
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X03
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			MOVLW		0X01
			ANDLW		0XFF
			MOVWF		PORTC
			CALL		MS300
			CLRF		PORTC		;AQUI TERMINA LAS SUBRUTINAS DE LEDS
			RETURN


MS300:		SUBT3V		.5,.86,.99
			RETURN

			INCLUDE		<D:\dtrej\Documents\Escuela\Micros\PROGRAMAS\VIDEOS\SUBRUTINAS\SUBRUTINASDETIEMPO.ASM>
			SUBT25MS
			END